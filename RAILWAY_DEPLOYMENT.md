# Деплой UMAY на Railway

## Подготовка к деплою

### 1. Установка Railway CLI
```bash
npm install -g @railway/cli
```

### 2. Авторизация в Railway
```bash
railway login
```

### 3. Инициализация проекта
```bash
railway init
```

## Структура файлов для Railway

Созданы следующие файлы:
- `railway.json` - конфигурация Railway
- `Procfile` - команда запуска
- `requirements.txt` - зависимости Python

## Переменные окружения

В Railway Dashboard добавьте следующие переменные:

### Обязательные:
```
SECRET_KEY=your-very-secure-secret-key-here
FLASK_ENV=production
```

### Для PostgreSQL (рекомендуется):
```
DATABASE_URL=postgresql://username:password@host:port/database
```

## Шаги деплоя

### 1. Подключение к Railway
```bash
railway link
```

### 2. Создание базы данных (если нужно)
```bash
railway add
```
Выберите PostgreSQL

### 3. Деплой
```bash
railway up
```

### 4. Открытие приложения
```bash
railway open
```

## Возможные проблемы и решения

### Проблема 1: Ошибка с psycopg2
**Решение:** Railway автоматически установит psycopg2-binary из requirements.txt

### Проблема 2: Ошибка с портом
**Решение:** Приложение настроено на использование переменной $PORT

### Проблема 3: Ошибка с базой данных
**Решение:** Убедитесь, что DATABASE_URL правильно настроен

### Проблема 4: Ошибка с статическими файлами
**Решение:** Статические файлы должны быть в папке static/

## Мониторинг

### Просмотр логов
```bash
railway logs
```

### Статус деплоя
```bash
railway status
```

## Обновление приложения

После внесения изменений:
```bash
railway up
```

## Полезные команды

```bash
# Просмотр переменных окружения
railway variables

# Просмотр доменов
railway domain

# Перезапуск приложения
railway restart
```

## Структура проекта для Railway

```
UMAY_stat/
├── app.py                 # Основное приложение
├── requirements.txt       # Зависимости Python
├── railway.json          # Конфигурация Railway
├── Procfile             # Команда запуска
├── static/              # Статические файлы
├── templates/           # HTML шаблоны
└── data/               # Локальные данные (не для продакшена)
```

## Примечания

1. **База данных**: Для продакшена используйте PostgreSQL, предоставляемый Railway
2. **Статические файлы**: Все статические файлы должны быть в папке `static/`
3. **Переменные окружения**: Никогда не коммитьте секретные ключи в git
4. **Логи**: Используйте `railway logs` для отладки

## Поддержка

Если возникли проблемы:
1. Проверьте логи: `railway logs`
2. Убедитесь, что все переменные окружения настроены
3. Проверьте, что база данных подключена
4. Убедитесь, что все зависимости установлены
