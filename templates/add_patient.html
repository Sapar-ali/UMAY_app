{% extends "base.html" %}

{% block title %}Добавить пациента - UMAY{% endblock %}

{% block content %}
<!-- Mobile Detection and Redirect -->
<script>
// Detect mobile device and redirect to mobile version
function isMobile() {
    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
           window.innerWidth <= 768;
}

// Only redirect if not already on mobile version
if (isMobile() && !window.location.search.includes('mobile=1')) {
    window.location.href = "{{ url_for('add_patient') }}?mobile=1";
}
</script>

<!-- Desktop Version -->
<!-- Modern Apple/BMW Style Form -->
<div class="apple-page-bg min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 relative overflow-hidden">
    <!-- Animated Background Elements -->
    <div class="absolute inset-0 overflow-hidden">
        <div class="absolute -top-40 -right-40 w-80 h-80 bg-blue-200 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"></div>
        <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-indigo-200 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"></div>
        <div class="absolute top-40 left-40 w-80 h-80 bg-purple-200 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"></div>
    </div>

    <!-- Main Content -->
    <div class="relative z-10 min-h-screen py-8 px-4">
        <div class="max-w-6xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-12 animate-fade-in">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-white mb-6 shadow-lg border border-gray-200">
                    <img src="{{ url_for('static', filename='assets/new-logo.png') }}" alt="UMAY" class="w-10 h-10 object-contain">
                </div>
                <h1 class="text-4xl font-bold text-gray-900 mb-4 tracking-tight">
                    Добавить данные роженицы
                </h1>
                <p class="text-xl text-gray-600 font-light">Введите полную информацию о пациентке</p>
            </div>

            <!-- Messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="mb-6 animate-slide-in">
                            <div class="bg-{{ 'red' if category == 'error' else 'green' }}-50 border-l-4 border-{{ 'red' if category == 'error' else 'green' }}-400 p-4 rounded-r-lg shadow-sm">
                                <div class="flex">
                                    <div class="flex-shrink-0">
                                        <i class="fas fa-{{ 'exclamation-triangle' if category == 'error' else 'check-circle' }} text-{{ 'red' if category == 'error' else 'green' }}-400"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm text-{{ 'red' if category == 'error' else 'green' }}-700">{{ message }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <!-- Modern Form -->
            <div class="apple-form-card bg-white/80 backdrop-blur-lg rounded-3xl shadow-2xl border border-white/50 animate-scale-in">
                <form method="POST" class="p-8 space-y-8">
                    <!-- Голосовой ввод пациента -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fas fa-microphone text-rose-500"></i>
                            </div>
                            <h2 class="section-title">Голосовой ввод пациента</h2>
                        </div>
                        <div class="form-group">
                            <voice-wizard
                                data-lang-primary="ru-KZ"
                                data-lang-fallback="ru-RU"
                                data-form-selector="form"
                                data-sys-selector='input[name="blood_pressure_sys"]'
                                data-dia-selector='input[name="blood_pressure_dia"]'
                                data-complications-selector='textarea[name="complications"]'
                                data-notes-selector='textarea[name="notes"]'>
                            </voice-wizard>
                        </div>
                    </div>
                    
                    <!-- Основная информация -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fas fa-user text-blue-500"></i>
                            </div>
                            <h2 class="section-title">Основная информация</h2>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-user-circle mr-2"></i>ФИО роженицы *
                                </label>
                                <input type="text" 
                                       name="patient_name" 
                                       required 
                                       class="form-input"
                                       placeholder="Введите полное имя">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-birthday-cake mr-2"></i>Возраст *
                                </label>
                                <input type="number" 
                                       name="age" 
                                       min="14" max="60" 
                                       value="25" 
                                       required 
                                       class="form-input"
                                       placeholder="25">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-calendar-week mr-2"></i>Срок беременности (недель) *
                                </label>
                                <input type="number" 
                                       name="pregnancy_weeks" 
                                       min="20" max="42" 
                                       value="38" 
                                       required 
                                       class="form-input"
                                       placeholder="38">
                            </div>
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-heart-pulse mr-2"></i>Артериальное давление (мм рт. ст.)
                                </label>
                                <div class="grid grid-cols-2 gap-3">
                                    <input type="number"
                                           name="blood_pressure_sys"
                                           min="50" max="300"
                                           class="form-input"
                                           placeholder="120">
                                    <input type="number"
                                           name="blood_pressure_dia"
                                           min="30" max="200"
                                           class="form-input"
                                           placeholder="80">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Вес -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fas fa-weight text-green-500"></i>
                            </div>
                            <h2 class="section-title">Показатели веса</h2>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-weight-hanging mr-2"></i>Вес до родов (кг) *
                                </label>
                                <input type="number" 
                                       name="weight_before" 
                                       min="40" max="150" 
                                       step="0.1" 
                                       value="70.0" 
                                       required 
                                       class="form-input"
                                       placeholder="70.0">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-weight-hanging mr-2"></i>Вес после родов (кг) *
                                </label>
                                <input type="number" 
                                       name="weight_after" 
                                       min="40" max="150" 
                                       step="0.1" 
                                       value="65.0" 
                                       required 
                                       class="form-input"
                                       placeholder="65.0">
                            </div>
                        </div>
                    </div>

                    <!-- Сопутствующие заболевания -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fas fa-heartbeat text-red-500"></i>
                            </div>
                            <h2 class="section-title">Сопутствующие заболевания</h2>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <div class="checkbox-group">
                                <input type="checkbox" id="gestosis" name="gestosis" class="checkbox-input">
                                <label for="gestosis" class="checkbox-label">
                                    <i class="fas fa-exclamation-triangle mr-2"></i>Гестоз
                                </label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="diabetes" name="diabetes" class="checkbox-input">
                                <label for="diabetes" class="checkbox-label">
                                    <i class="fas fa-tint mr-2"></i>Сахарный диабет
                                </label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="hypertension" name="hypertension" class="checkbox-input">
                                <label for="hypertension" class="checkbox-label">
                                    <i class="fas fa-heart mr-2"></i>Гипертония
                                </label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="anemia" name="anemia" class="checkbox-input">
                                <label for="anemia" class="checkbox-label">
                                    <i class="fas fa-droplet mr-2"></i>Анемия
                                </label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="infections" name="infections" class="checkbox-input">
                                <label for="infections" class="checkbox-label">
                                    <i class="fas fa-virus mr-2"></i>Инфекции
                                </label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="placenta_pathology" name="placenta_pathology" class="checkbox-input">
                                <label for="placenta_pathology" class="checkbox-label">
                                    <i class="fas fa-baby mr-2"></i>Патология плаценты
                                </label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="polyhydramnios" name="polyhydramnios" class="checkbox-input">
                                <label for="polyhydramnios" class="checkbox-label">
                                    <i class="fas fa-water mr-2"></i>Многоводие
                                </label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="oligohydramnios" name="oligohydramnios" class="checkbox-input">
                                <label for="oligohydramnios" class="checkbox-label">
                                    <i class="fas fa-tint-slash mr-2"></i>Маловодие
                                </label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="pls" name="pls" class="checkbox-input">
                                <label for="pls" class="checkbox-label">
                                    <i class="fas fa-exclamation-triangle mr-2 text-orange-500"></i>ПЛС
                                </label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="pts" name="pts" class="checkbox-input">
                                <label for="pts" class="checkbox-label">
                                    <i class="fas fa-exclamation-triangle mr-2 text-red-600"></i>ПТС
                                </label>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="eclampsia" name="eclampsia" class="checkbox-input">
                                <label for="eclampsia" class="checkbox-label">
                                    <i class="fas fa-exclamation-triangle mr-2 text-red-700"></i>Эклампсия
                                </label>
                            </div>
                        </div>
                        
                        <!-- Осложнения в родах -->
                        <div class="mt-8">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-exclamation-triangle text-red-500 mr-2"></i>
                                Осложнения в родах
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="gestational_hypertension" name="gestational_hypertension" class="checkbox-input">
                                    <label for="gestational_hypertension" class="checkbox-label">
                                        <i class="fas fa-heart mr-2 text-orange-500"></i>Гестационная гипертензия
                                    </label>
                                </div>
                                
                                <div class="checkbox-group">
                                    <input type="checkbox" id="placenta_previa" name="placenta_previa" class="checkbox-input">
                                    <label for="placenta_previa" class="checkbox-label">
                                        <i class="fas fa-baby mr-2 text-red-500"></i>Плотное прикрепление последа
                                    </label>
                                </div>
                                
                                <div class="checkbox-group">
                                    <input type="checkbox" id="shoulder_dystocia" name="shoulder_dystocia" class="checkbox-input">
                                    <label for="shoulder_dystocia" class="checkbox-label">
                                        <i class="fas fa-exclamation-triangle mr-2 text-red-600"></i>Дистоция плечиков
                                    </label>
                                </div>
                                
                                <div class="checkbox-group">
                                    <input type="checkbox" id="third_degree_tear" name="third_degree_tear" class="checkbox-input">
                                    <label for="third_degree_tear" class="checkbox-label">
                                        <i class="fas fa-exclamation-triangle mr-2 text-red-700"></i>Разрыв 3 степени
                                    </label>
                                </div>
                                
                                <div class="checkbox-group">
                                    <input type="checkbox" id="cord_prolapse" name="cord_prolapse" class="checkbox-input">
                                    <label for="cord_prolapse" class="checkbox-label">
                                        <i class="fas fa-exclamation-triangle mr-2 text-red-800"></i>Выпадение петель пуповины
                                    </label>
                                </div>
                                
                                <div class="checkbox-group">
                                    <input type="checkbox" id="postpartum_hemorrhage" name="postpartum_hemorrhage" class="checkbox-input">
                                    <label for="postpartum_hemorrhage" class="checkbox-label">
                                        <i class="fas fa-tint mr-2 text-red-600"></i>ПРК
                                    </label>
                                </div>
                                
                                <div class="checkbox-group">
                                    <input type="checkbox" id="placental_abruption" name="placental_abruption" class="checkbox-input">
                                    <label for="placental_abruption" class="checkbox-label">
                                        <i class="fas fa-exclamation-triangle mr-2 text-red-900"></i>ПОНРП
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6">
                            <label class="form-label">
                                <i class="fas fa-plus-circle mr-2"></i>Другие заболевания
                            </label>
                            <textarea name="other_diseases" 
                                      class="form-textarea" 
                                      rows="3" 
                                      placeholder="Укажите другие заболевания, если были..."></textarea>
                        </div>
                    </div>

                    <!-- Информация о родах -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fas fa-baby text-pink-500"></i>
                            </div>
                            <h2 class="section-title">Информация о родах</h2>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-calendar mr-2"></i>Дата родов *
                                </label>
                                <input type="date" 
                                       name="birth_date" 
                                       required 
                                       class="form-input">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-clock mr-2"></i>Время родов *
                                </label>
                                <input type="time" 
                                       name="birth_time" 
                                       required 
                                       class="form-input">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-venus-mars mr-2"></i>Пол ребенка *
                                </label>
                                <select name="child_gender" required class="form-select">
                                    <option value="">Выберите пол</option>
                                    <option value="Мальчик">👶 Мальчик</option>
                                    <option value="Девочка">👧 Девочка</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-weight-hanging mr-2"></i>Вес ребенка (г) *
                                </label>
                                <input type="number" 
                                       name="child_weight" 
                                       min="500" max="6000" 
                                       value="3500" 
                                       step="50" 
                                       required 
                                       class="form-input"
                                       placeholder="3500">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-baby-carriage mr-2"></i>Способ родоразрешения *
                                </label>
                                <select name="delivery_method" required class="form-select">
                                    <option value="">Выберите способ</option>
                                    <option value="Естественные роды">🟢 Естественные роды</option>
                                    <option value="Кесарево сечение">🔴 Кесарево сечение</option>
                                    <option value="Вакуум-экстракция">🟡 Вакуум-экстракция</option>
                                    <option value="Акушерские щипцы">🟠 Акушерские щипцы</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-syringe mr-2"></i>Анестезия *
                                </label>
                                <select name="anesthesia" required class="form-select">
                                    <option value="">Выберите тип</option>
                                    <option value="Нет">❌ Нет</option>
                                    <option value="Эпидуральная">💉 Эпидуральная</option>
                                    <option value="Спинальная">💉 Спинальная</option>
                                    <option value="Общая">💊 Общая</option>
                                    <option value="Местная">💉 Местная</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-tint mr-2"></i>Кровопотеря (мл) *
                                </label>
                                <input type="number" 
                                       name="blood_loss" 
                                       min="0" max="2000" 
                                       value="300" 
                                       step="50" 
                                       required 
                                       class="form-input"
                                       placeholder="300">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-hourglass mr-2"></i>Продолжительность родов (часов) *
                                </label>
                                <input type="number" 
                                       name="labor_duration" 
                                       min="0.5" max="24" 
                                       value="8.0" 
                                       step="0.5" 
                                       required 
                                       class="form-input"
                                       placeholder="8.0">
                            </div>
                        </div>
                    </div>

                    <!-- Дополнительная информация -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fas fa-notes-medical text-purple-500"></i>
                            </div>
                            <h2 class="section-title">Дополнительная информация</h2>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-exclamation-triangle mr-2"></i>Осложнения в родах
                                </label>
                                <textarea name="complications" 
                                          class="form-textarea" 
                                          rows="4" 
                                          placeholder="Опишите осложнения во время родов, если были..."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-sticky-note mr-2"></i>Примечания
                                </label>
                                <textarea name="notes" 
                                          class="form-textarea" 
                                          rows="4" 
                                          placeholder="Дополнительные заметки..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-comment-medical mr-2"></i>Жалобы
                                </label>
                                <textarea name="complaints"
                                          class="form-textarea"
                                          rows="4"
                                          placeholder="Опишите жалобы пациентки (например: головная боль, отеки, боли внизу живота)"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex flex-col sm:flex-row gap-4 justify-end pt-8 border-t border-gray-200">
                        <a href="{{ url_for('dashboard') }}" 
                           class="btn-secondary">
                            <i class="fas fa-arrow-left mr-2"></i>Отмена
                        </a>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save mr-2"></i>Сохранить данные
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<style>
/* Animations */
@keyframes blob {
    0% { transform: translate(0px, 0px) scale(1); }
    33% { transform: translate(30px, -50px) scale(1.1); }
    66% { transform: translate(-20px, 20px) scale(0.9); }
    100% { transform: translate(0px, 0px) scale(1); }
}

.animate-blob {
    animation: blob 7s infinite;
}

.animation-delay-2000 {
    animation-delay: 2s;
}

.animation-delay-4000 {
    animation-delay: 4s;
}

.animate-fade-in {
    animation: fadeIn 1s ease-out;
}

.animate-scale-in {
    animation: scaleIn 0.6s ease-out;
}

.animate-slide-in {
    animation: slideIn 0.5s ease-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes scaleIn {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
}

@keyframes slideIn {
    from { opacity: 0; transform: translateX(-20px); }
    to { opacity: 1; transform: translateX(0); }
}

/* Apple-like dark theme for this page */
[data-theme="dark"] .apple-page-bg {
    background: radial-gradient(60% 70% at 50% 0%, rgba(30, 41, 59, 0.65) 0%, rgba(11, 18, 32, 0.65) 45%, rgba(10, 15, 26, 0.8) 100%),
                linear-gradient(180deg, #0b1220 0%, #0a0f1a 100%);
}
[data-theme="dark"] .apple-page-bg .animate-blob {
    opacity: 0.22;
    filter: blur(36px) saturate(110%);
}
[data-theme="dark"] .apple-form-card {
    background: rgba(12, 17, 27, 0.72);
    border-color: rgba(148, 163, 184, 0.12);
}

/* Form Sections */
.form-section {
    @apply space-y-6;
}

.section-header {
    @apply flex items-center space-x-4 mb-6;
}

.section-icon {
    @apply w-12 h-12 rounded-2xl bg-gradient-to-r from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg;
}

.section-icon i {
    @apply text-white text-xl;
}

.section-title {
    @apply text-2xl font-bold text-gray-900;
}

/* Form Groups */
.form-group {
    @apply space-y-2;
}

.form-label {
    @apply block text-sm font-semibold text-gray-700 flex items-center;
}

.form-input, .form-select, .form-textarea {
    @apply w-full px-4 py-3 bg-white/80 backdrop-blur-sm border-2 border-gray-200 rounded-2xl text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:bg-white focus:ring-4 focus:ring-blue-100 transition-all duration-300 text-lg;
}

.form-input:focus, .form-select:focus, .form-textarea:focus {
    @apply outline-none transform scale-[1.02];
}

.form-textarea {
    @apply resize-none;
}

/* Checkbox Groups */
.checkbox-group {
    @apply flex items-center space-x-3 p-4 bg-white/60 backdrop-blur-sm rounded-2xl border border-gray-200 hover:bg-white/80 transition-all duration-300 cursor-pointer;
}

.checkbox-group:hover {
    @apply transform scale-[1.02] shadow-md;
}

.checkbox-input {
    @apply w-5 h-5 text-blue-600 bg-white border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-300;
}

.checkbox-label {
    @apply text-sm font-medium text-gray-700 cursor-pointer flex items-center;
}

/* Buttons */
.btn-primary {
    @apply bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-bold py-4 px-8 rounded-2xl transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center space-x-2 text-lg;
}

.btn-secondary {
    @apply bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-4 px-8 rounded-2xl transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center space-x-2 text-lg;
}

/* Responsive Design */
@media (max-width: 768px) {
    .grid {
        @apply grid-cols-1;
    }
    
    .section-header {
        @apply flex-col space-y-2;
    }
    
    .btn-primary, .btn-secondary {
        @apply w-full;
    }
}

/* Custom scrollbar */
::-webkit-scrollbar {
    width: 8px;
}

::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
}

::-webkit-scrollbar-thumb {
    background: linear-gradient(to bottom, #3b82f6, #6366f1);
    border-radius: 10px;
}

::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(to bottom, #2563eb, #4f46e5);
}
</style>

<script defer src="{{ url_for('static', filename='js/voice_wizard.js') }}"></script>
<script>
// Form validation and enhancements
document.addEventListener('DOMContentLoaded', function() {
    // Set current date as default
    const today = new Date().toISOString().split('T')[0];
    const birthDateInput = document.querySelector('input[name="birth_date"]');
    if (birthDateInput) {
        birthDateInput.value = today;
    }
    
    // Add smooth animations to form inputs
    document.querySelectorAll('.form-input, .form-select, .form-textarea').forEach(input => {
        input.addEventListener('focus', function() {
            this.parentElement.classList.add('scale-105');
        });
        
        input.addEventListener('blur', function() {
            this.parentElement.classList.remove('scale-105');
        });
    });
    
    // Checkbox animations
    document.querySelectorAll('.checkbox-input').forEach(checkbox => {
        checkbox.addEventListener('change', function() {
            const group = this.closest('.checkbox-group');
            if (this.checked) {
                group.classList.add('bg-blue-50', 'border-blue-300');
            } else {
                group.classList.remove('bg-blue-50', 'border-blue-300');
            }
        });
    });
    
    // Form validation
    const form = document.querySelector('form');
    form.addEventListener('submit', function(e) {
        const requiredFields = form.querySelectorAll('[required]');
        let isValid = true;
        
        requiredFields.forEach(field => {
            if (!field.value.trim()) {
                field.classList.add('border-red-500', 'bg-red-50');
                isValid = false;
            } else {
                field.classList.remove('border-red-500', 'bg-red-50');
            }
        });
        
        if (!isValid) {
            e.preventDefault();
            // Show error message
            const errorDiv = document.createElement('div');
            errorDiv.className = 'bg-red-50 border-l-4 border-red-400 p-4 rounded-r-lg shadow-sm mb-6 animate-slide-in';
            errorDiv.innerHTML = `
                <div class="flex">
                    <div class="flex-shrink-0">
                        <i class="fas fa-exclamation-triangle text-red-400"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm text-red-700">Пожалуйста, заполните все обязательные поля.</p>
                    </div>
                </div>
            `;
            form.insertBefore(errorDiv, form.firstChild);
        }
    });
});
</script>
{% endblock %} 